<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Опциональная цепочка</title>
</head>

<body>
  <h3>Опциональная цепочка</h3>
  <p>
    Опциональная цепочка ?. останавливает вычисление и возвращает undefined, если значение перед ?. равно undefined или
    null.
    Далее в этой статье, для краткости, мы будем говорить, что что-то «существует», если оно не является null и не
    undefined.
    Другими словами, value?.prop:

    работает как value.prop, если значение value существует,
    в противном случае (когда value равно undefined/null) он возвращает undefined.

    Вот безопасный способ получить доступ к user.address.street, используя ?.:

    let user = {}; // пользователь без адреса
    alert( user?.address?.street ); // undefined (без ошибки)
  </p>

  <h3>Сокращённое вычисление</h3>
  <p>
    Как было сказано ранее, ?. немедленно останавливает вычисление, если левая часть не существует.
    Так что если после ?. есть какие-то вызовы функций или операции, то они не произойдут.
    Например:

    let user = null;
    let x = 0;
    user?.sayHi(x++); // нет "user", поэтому выполнение не достигает вызова sayHi и x++
    alert(x); // 0, значение не увеличилось
  </p>
  <h3>Другие варианты применения: ?.(), ?.[]</h3>
  <p>
    Опциональная цепочка ?. — это не оператор, а специальная синтаксическая конструкция, которая также работает с
    функциями и квадратными скобками.

    Например, ?.() используется для вызова функции, которая может не существовать.

    В приведённом ниже коде у некоторых наших пользователей есть метод admin, а у некоторых его нет:

    let userAdmin = {
    admin() {
    alert("Я админ");
    }
    };
    let userGuest = {};
    userAdmin.admin?.(); // Я админ
    userGuest.admin?.(); // ничего не произойдет (такого метода нет)

    Здесь в обеих строках мы сначала используем точку (userAdmin.admin), чтобы получить свойство admin, потому что мы
    предполагаем, что объект user существует, так что читать из него безопасно.

    Затем ?.() проверяет левую часть: если функция admin существует, то она запускается (это так для userAdmin). В
    противном случае (для userGuest) вычисление остановится без ошибок.

    Синтаксис ?.[] также работает, если мы хотим использовать скобки [] для доступа к свойствам вместо точки .. Как и в
    предыдущих случаях, он позволяет безопасно считывать свойство из объекта, который может не существовать.
  </p>

  <h3>Итого</h3>
  <p>
    Синтаксис опциональной цепочки ?. имеет три формы:
    1) obj?.prop – возвращает obj.prop если obj существует, в противном случае undefined.
    2) obj?.[prop] – возвращает obj[prop] если obj существует, в противном случае undefined.
    3) obj.method?.() – вызывает obj.method(), если obj.method существует, в противном случае возвращает undefined.

    Как мы видим, все они просты и понятны в использовании. ?. проверяет левую часть на null/undefined и позволяет
    продолжить вычисление, если это не так.
    Цепочка ?. позволяет безопасно получать доступ к вложенным свойствам.
    Тем не менее, мы должны использовать ?. осторожно, только там, где по логике кода допустимо, что левая часть не
    существует. Чтобы он не скрывал от нас ошибки программирования, если они возникнут.
  </p>
</body>

</html>