<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Функции конструктора объекта</title>
</head>

<body>
  <h3>
    Конструктор, оператор "new"
  </h3>
  <p>
    Обычный синтаксис {...} позволяет создать только один объект. Но зачастую нам нужно создать множество похожих,
    однотипных объектов, таких как пользователи, элементы меню и так далее.
    Это можно сделать при помощи функции-конструктора и оператора "new".
  </p>

  <h3>Функция-конструктор</h3>
  <p>
    Функции-конструкторы технически являются обычными функциями. Но есть два соглашения:
    1. Имя функции-конструктора должно начинаться с большой буквы.
    2. Функция-конструктор должна выполняться только с помощью оператора "new".
  </p>
  <script>
    function User(name) {
      this.name = name;
      this.isAdmin = false;
    }
    let user = new User("Jack");
    alert(user.name); // Jack
    alert(user.isAdmin); // false
  </script>

  <p>
    Когда функция вызывается как new User(...), происходит следующее:
    1. Создаётся новый пустой объект, и он присваивается this.
    2. Выполняется тело функции. Обычно оно модифицирует this, добавляя туда новые свойства.
    3. Возвращается значение this.
  </p>
  <script>
    function User(name) {
      // this = {};  (неявно)
      // добавляет свойства к this
      this.name = name;
      this.isAdmin = false;
      // return this;  (неявно)
    }
  </script>
  <p>
    Таким образом, let user = new User("Jack") возвращает тот же результат, что и:

    let user = {
    name: "Jack",
    isAdmin: false
    };
  </p>

  <h3>Возврат значения из конструктора, return</h3>
  <p>
    Обычно конструкторы не имеют оператора return. Их задача – записать все необходимое в this, и это автоматически
    становится результатом.

    Но если return всё же есть, то применяется простое правило:

    При вызове return с объектом, вместо this вернётся объект.
    При вызове return с примитивным значением, оно проигнорируется.

    Другими словами, return с объектом возвращает этот объект, во всех остальных случаях возвращается this.
  </p>
  <script>
    function BigUser() {

      this.name = "John";

      return { name: "Godzilla" };  // <-- возвращает этот объект
    }

    alert(new BigUser().name);  // Godzilla, получили этот объект
  </script>
  <h3> Пропуск скобок</h3>
  <p>
    Кстати, мы можем не ставить круглые скобки после new:

    let user = new User; // <-- без скобок // то же, что и let user=new User(); Пропуск скобок считается плохой
      практикой, но просто чтобы вы знали, такой синтаксис разрешён спецификацией. </p>

      <h3>Создание методов в конструкторе</h3>
      <p>
        Использование конструкторов для создания объектов даёт большую гибкость. Функции-конструкторы могут иметь
        параметры,
        определяющие, как создавать объект и что в него записывать.

        Конечно, мы можем добавить к this не только свойства, но и методы.
        Например, new User(name) ниже создаёт объект с заданным name и методом sayHi:
      </p>
      <script>
        function User(name) {
          this.name = name;

          this.sayHi = function () {
            alert("Меня зовут: " + this.name);
          };
        }

        let john = new User("John");

        john.sayHi(); // Меня зовут: John

        /*
        john = {
           name: "John",
           sayHi: function() { ... }
        }
        */
      </script>
      <h3>Итого</h3>
      <p>

        Функции-конструкторы или просто конструкторы, являются обычными функциями, но существует общепринятое соглашение
        именовать их с заглавной буквы.
        Функции-конструкторы следует вызывать только с помощью new. Такой вызов подразумевает создание пустого this в
        начале и возврат заполненного в конце.

        Мы можем использовать конструкторы для создания множества похожих объектов.

        JavaScript предоставляет функции-конструкторы для множества встроенных объектов языка: таких как Date, Set, и
        других
      </p>

      
</body>

</html>