<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Копирование обьекта и ссылки</title>
</head>

<body>
  <h2>Копирование обьекта через цикл for...in</h2>
  <p>
    let user = {
    name: "John",
    age: 30
    };

    let clone = {}; // новый пустой объект

    // давайте скопируем все свойства user в него
    for (let key in user) {
    clone[key] = user[key];
    }

    // теперь clone это полностью независимый объект с тем же содержимым
    clone.name = "Pete"; // изменим в нём данные

    alert( user.name ); // все ещё John в первоначальном объекте
  </p>
  <p>Клонирование через команду aasign
    let user = {
    name: "John",
    age: 30
    };

    let clone = Object.assign({}, user); // тут копируется базовый обьект + к нему можно добавить свойства
  </p>

  <h2>Вложенное клонирование</h2>
  <p>
    До сих пор мы предполагали, что все свойства user примитивныe. Но свойства могут быть и ссылками на другие объекты.
    Что с ними делать?
    Теперь недостаточно просто скопировать clone.sizes = user.sizes, потому что user.sizes – это объект, он будет
    скопирован по ссылке.

    let user = {
    name: "John",
    sizes: {
    height: 182,
    width: 50
    }
    };

    let clone = Object.assign({}, user);

    alert( user.sizes === clone.sizes ); // true, тот же объект

    // user и clone обладают общим свойством sizes
    user.sizes.width++; // изменяем свойства в первом объекте
    alert(clone.sizes.width); // 51, видим результат в другом
  </p>

  <h2>Итого</h2>
  <p>
    Объекты присваиваются и копируются по ссылке. Другими словами, переменная хранит не «значение объекта», а «ссылку»
    (адрес в памяти) на это значение. Таким образом, копирование такой переменной или передача её в качестве аргумента
    функции копирует эту ссылку, а не сам объект.

    Все операции с использованием скопированных ссылок (например, добавление/удаление свойств) выполняются с одним и тем
    же объектом.

    Чтобы создать «реальную копию» (клон), мы можем использовать Object.assign для так называемой «поверхностной копии»
    (вложенные объекты копируются по ссылке) или функцию «глубокого клонирования», такую как _.cloneDeep(obj).
  </p>
</body>

</html>